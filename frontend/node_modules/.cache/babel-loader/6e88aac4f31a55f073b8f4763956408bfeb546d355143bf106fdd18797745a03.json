{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DURAND\\\\Downloads\\\\githup\\\\spayr-lite\\\\frontend\\\\src\\\\pages\\\\SpayrLite.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport api from \"../services/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function SpayrLite() {\n  _s();\n  const [user, setUser] = useState({\n    name: \"Durand\",\n    balance: 0\n  });\n  const [history, setHistory] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  // Récupère le solde et l'historique depuis le backend\n  const fetchData = async () => {\n    try {\n      // Récupère l'historique\n      const histRes = await api.get(\"/history\");\n      setHistory(histRes.data.history);\n      // Récupère le solde utilisateur\n      const username = \"Durand\"; // à remplacer par le vrai nom si besoin\n      const dbRes = await api.get(`/user/${username}`);\n      setUser({\n        name: username,\n        balance: dbRes.data.balance\n      });\n    } catch (e) {\n      setError(\"Erreur lors du chargement des données.\");\n    }\n  };\n\n  // Demande une avance\n  const requestAdvance = async () => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      const username = \"Durand\"; // à remplacer par le vrai nom si besoin\n      const amount = 200;\n      const res = await api.post(\"/advance\", {\n        username,\n        amount\n      });\n      if (res.data.error) {\n        setError(res.data.error);\n      } else {\n        setUser(prev => ({\n          ...prev,\n          balance: res.data.new_balance\n        }));\n        fetchData();\n      }\n    } catch (e) {\n      setError(\"Erreur lors de la demande d'avance.\");\n    }\n    setLoading(false);\n  };\n  useEffect(() => {\n    fetchData();\n    // eslint-disable-next-line\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-xl mx-auto p-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-2xl font-bold mb-4\",\n      children: \"Spayr Lite\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4 text-red-600 bg-red-100 p-2 rounded\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      className: \"mb-4\",\n      children: /*#__PURE__*/_jsxDEV(CardContent, {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-lg\",\n          children: [\"Bonjour, \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: user.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 43\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xl\",\n          children: [\"Solde actuel : \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: [user.balance, \" \\u20AC\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 49\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      onClick: requestAdvance,\n      disabled: loading,\n      className: \"mb-4\",\n      children: loading ? \"Traitement...\" : \"Demander une avance (200€)\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      children: /*#__PURE__*/_jsxDEV(CardContent, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-lg font-semibold mb-2\",\n          children: \"Historique des avances\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"space-y-1\",\n          children: history.map((item, idx) => /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"text-sm\",\n            children: [item.date, \" - \", item.amount, \" \\u20AC\"]\n          }, idx, true, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n}\n_s(SpayrLite, \"zRPssH/fY0Ms4QN/hDgmYNC6RvY=\");\n_c = SpayrLite;\nvar _c;\n$RefreshReg$(_c, \"SpayrLite\");","map":{"version":3,"names":["useEffect","useState","Card","CardContent","Button","api","jsxDEV","_jsxDEV","SpayrLite","_s","user","setUser","name","balance","history","setHistory","loading","setLoading","error","setError","fetchData","histRes","get","data","username","dbRes","e","requestAdvance","amount","res","post","prev","new_balance","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","map","item","idx","date","_c","$RefreshReg$"],"sources":["C:/Users/DURAND/Downloads/githup/spayr-lite/frontend/src/pages/SpayrLite.jsx"],"sourcesContent":["import { useEffect, useState } from 'react'\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport api from \"../services/api\"\r\n\r\nexport default function SpayrLite() {\r\n  const [user, setUser] = useState({ name: \"Durand\", balance: 0 })\r\n  const [history, setHistory] = useState([])\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState(\"\")\r\n\r\n  // Récupère le solde et l'historique depuis le backend\r\n  const fetchData = async () => {\r\n    try {\r\n      // Récupère l'historique\r\n      const histRes = await api.get(\"/history\")\r\n      setHistory(histRes.data.history)\r\n      // Récupère le solde utilisateur\r\n      const username = \"Durand\" // à remplacer par le vrai nom si besoin\r\n      const dbRes = await api.get(`/user/${username}`)\r\n      setUser({ name: username, balance: dbRes.data.balance })\r\n    } catch (e) {\r\n      setError(\"Erreur lors du chargement des données.\")\r\n    }\r\n  }\r\n\r\n  // Demande une avance\r\n  const requestAdvance = async () => {\r\n    setLoading(true)\r\n    setError(\"\")\r\n    try {\r\n      const username = \"Durand\" // à remplacer par le vrai nom si besoin\r\n      const amount = 200\r\n      const res = await api.post(\"/advance\", { username, amount })\r\n      if (res.data.error) {\r\n        setError(res.data.error)\r\n      } else {\r\n        setUser(prev => ({ ...prev, balance: res.data.new_balance }))\r\n        fetchData()\r\n      }\r\n    } catch (e) {\r\n      setError(\"Erreur lors de la demande d'avance.\")\r\n    }\r\n    setLoading(false)\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchData()\r\n    // eslint-disable-next-line\r\n  }, [])\r\n\r\n  return (\r\n    <div className=\"max-w-xl mx-auto p-4\">\r\n      <h1 className=\"text-2xl font-bold mb-4\">Spayr Lite</h1>\r\n\r\n      {error && (\r\n        <div className=\"mb-4 text-red-600 bg-red-100 p-2 rounded\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      <Card className=\"mb-4\">\r\n        <CardContent>\r\n          <p className=\"text-lg\">Bonjour, <strong>{user.name}</strong></p>\r\n          <p className=\"text-xl\">Solde actuel : <strong>{user.balance} €</strong></p>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Button onClick={requestAdvance} disabled={loading} className=\"mb-4\">\r\n        {loading ? \"Traitement...\" : \"Demander une avance (200€)\"}\r\n      </Button>\r\n\r\n      <Card>\r\n        <CardContent>\r\n          <h2 className=\"text-lg font-semibold mb-2\">Historique des avances</h2>\r\n          <ul className=\"space-y-1\">\r\n            {history.map((item, idx) => (\r\n              <li key={idx} className=\"text-sm\">{item.date} - {item.amount} €</li>\r\n            ))}\r\n          </ul>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}